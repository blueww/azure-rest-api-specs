{
  "swagger": "2.0",
  "info": {
    "title": "Azure Data Migration Service Resource Provider",
    "version": "2017-04-15-privatepreview"
  },
  "securityDefinitions": {
    "azure_auth": {
      "type": "oauth2",
      "authorizationUrl": "https://login.microsoftonline.com/common/oauth2/authorize",
      "flow": "implicit",
      "description": "Azure Active Directory OAuth2 Flow",
      "scopes": {
        "user_impersonation": "impersonate your user account"
      }
    }
  },
  "paths": {},
  "definitions": {
    "MigrateSqlServerCloudDbTaskProperties": {
      "x-ms-discriminator-value": "Migrate.SqlServer.CloudDb",
      "type": "object",
      "description": "Properties for task that migrates SQL Server databases to Cloud DB",
      "properties": {
        "input": {
          "description": "Task input",
          "$ref": "#/definitions/MigrateSqlServerCloudDbTaskInput"
        },
        "output": {
          "description": "Task output. This is ignored if submitted.",
          "type": "array",
          "items": {
            "$ref": "#/definitions/MigrateSqlServerCloudDbTaskOutput"
          },
          "readOnly": true
        }
      },
      "allOf": [
        {
          "$ref": "./Tasks.json#/definitions/ProjectTaskProperties"
        }
      ]
    },
    "MigrateSqlServerCloudDbTaskInput": {
      "type": "object",
      "description": "Input for task that migrates SQL Server databases to Cloud DB",
      "allOf": [
        {
          "$ref": "./TasksCommon.json#/definitions/SqlMigrationTaskInput"
        }
      ],
      "properties": {
        "selectedDatabases": {
          "description": "Databases to migrate",
          "type": "array",
          "items": {
            "$ref": "./TasksCommon.json#/definitions/MigrateSqlServerSqlServerDatabaseInput"
          }
        },
        "backupShareUserName": {
          "type": "string",
          "description": "User name credential to connect to the backup share location"
        },
        "backupSharePassword": {
          "type": "string",
          "description": "Password credential used to connect to the backup share location. It must be RSA encrypted by the public key of the VM, then base64 encoded. It must never be the plaintext! Cryptography class contains helper methods to perform the encryption.\n"
        }
      },
      "required": [
        "selectedDatabases",
        "backupShareUserName"
      ]
    },
    "MigrateSqlServerCloudDbTaskOutput": {
      "type": "object",
      "description": "Output for task that migrates SQL Server databases to Cloud DB",
      "properties": {
        "resultType": {
          "description": "Result type",
          "type": "string"
        }
      },
      "allOf": [
        {
          "$ref": "./Tasks.json#/definitions/TaskOutput"
        }
      ],
      "required": [ "resultType" ],
      "discriminator": "resultType"
    },
    "MigrateSqlServerCloudDbTaskOutputMigrationLevel": {
      "type": "object",
      "x-ms-discriminator-value": "MigrationLevelOutput",
      "properties": {
        "startedOn": {
          "type": "string",
          "format": "date-time",
          "description": "Migration start time",
          "readOnly": true
        },
        "endedOn": {
          "type": "string",
          "format": "date-time",
          "description": "Migration end time",
          "readOnly": true
        },
        "status": {
          "$ref": "TasksCommon.json#/definitions/MigrationStatus",
          "description": "Current status of migration",
          "readOnly": true
        },
        "state": {
          "$ref": "TasksCommon.json#/definitions/MigrationState",
          "description": "Current state of migration",
          "readOnly": true
        },
        "statusMessage": {
          "type": "string",
          "description": "Migration status message",
          "readOnly": true
        },
        "message": {
          "type": "string",
          "description": "Migration progress message",
          "readOnly": true
        },
        "databases": {
          "type": "string",
          "description": "Selected databases as a map from database name to database id",
          "additionalProperties": {
            "type": "string"
          },
          "readOnly": true
        },
        "databaseSummary": {
          "type": "string",
          "description": "Summary of database results in the migration",
          "additionalProperties": {
            "$ref": "TasksCommon.json#/definitions/DataItemMigrationSummaryResult"
          },
          "readOnly": true
        },
        "sourceServerVersion": {
          "type": "string",
          "description": "Source server version",
          "readOnly": true
        },
        "sourceServerBrandVersion": {
          "type": "string",
          "description": "Source server brand version",
          "readOnly": true
        },
        "targetServerVersion": {
          "type": "string",
          "description": "Target server version",
          "readOnly": true
        },
        "targetServerBrandVersion": {
          "type": "string",
          "description": "Target server brand version",
          "readOnly": true
        },
        "exceptionsAndWarnings": {
          "description": "Migration exceptions and warnings.",
          "type": "array",
          "items": {
            "$ref": "./Common.json#/definitions/ReportableException"
          },
          "readOnly": true
        }
      },
      "allOf": [
        {
          "$ref": "#/definitions/MigrateSqlServerCloudDbTaskOutput"
        }
      ]
    },
    "MigrateSqlServerCloudDbTaskOutputDatabaseLevel": {
      "type": "object",
      "x-ms-discriminator-value": "DatabaseLevelOutput",
      "properties": {
        "databaseName": {
          "type": "string",
          "description": "Name of the database",
          "readOnly": true
        },
        "state": {
          "$ref": "./TasksCommon.json#/definitions/MigrationState",
          "description": "Current state of migration",
          "readOnly": true
        },
        "stage": {
          "$ref": "./TasksCommon.json#/definitions/DatabaseMigrationStage",
          "description": "Current stage of migration",
          "readOnly": true
        },
        "startedOn": {
          "type": "string",
          "format": "date-time",
          "description": "Migration start time",
          "readOnly": true
        },
        "endedOn": {
          "type": "string",
          "format": "date-time",
          "description": "Migration end time",
          "readOnly": true
        },
        "message": {
          "type": "string",
          "description": "Migration progress message",
          "readOnly": true
        },
        "exceptionsAndWarnings": {
          "description": "Migration exceptions and warnings",
          "type": "array",
          "items": {
            "$ref": "Common.json#/definitions/ReportableException"
          },
          "readOnly": true
        }
      },
      "allOf": [
        {
          "$ref": "#/definitions/MigrateSqlServerCloudDbTaskOutput"
        }
      ]
    },
    "MigrateSqlServerCloudDbTaskOutputError": {
      "type": "object",
      "x-ms-discriminator-value": "ErrorOutput",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the exception",
          "readOnly": true
        },
        "error": {
          "$ref": "Common.json#/definitions/ReportableException",
          "description": "Migration error",
          "readOnly": true
        }
      },
      "allOf": [
        {
          "$ref": "#/definitions/MigrateSqlServerCloudDbTaskOutput"
        }
      ]
    }
  }
}
